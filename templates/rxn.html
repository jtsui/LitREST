<!DOCTYPE html>
<html>
<body>

<h2>
  Reaction Visualizer (on port 27334 w/ Litmining Reactions)
</h2>

<p>
  Instructions: To view a reaction go to /rxn/(rxn_id).
</p>

{% if reaction %}
<table border="1">
<tr>
  <td>ID</td>
  <td>{{ reaction['_id']  }}</td>
</tr>
<tr>
  <td>Description</td>
  <td>{{ reaction['easy_desc']  }}</td>
</tr>
<tr>
  <td>Ecnum</td>
  <td>{{ reaction['ecnum']  }}</td>
</tr>
<tr>
  <td>References</td>
  <td>{{ reaction['references']  }}</td>
</tr>
<tr>
  <td>Organisms</td>
  <td>{{ reaction['organisms']  }}</td>
</tr>
<tr>
  <td>Metadata</td>
  <td>
    {% for res in reaction['metadata'] %}
    <table border="0">
      {% for k, v in res.iteritems() %}
        <tr>
          <td>{{ k }}</td>
          <td>{{ v }}</td>
        </tr>
      {% endfor %}
    </table>
    <br>
    {% endfor %}
  </td>
</tr>
</table>
<br>
<img src="{{ rxn_img }}">
<h3>Substrates</h3>
{% for chemical in substrates %}
<table border="1">
  <tr>
    <td>ID</td>
    <td>{{ chemical['_id']  }}</td>
  </tr>
  <tr>
    <td>canonical</td>
    <td>{{ chemical['canonical']  }}</td>
  </tr>
  <tr>
    <td>smiles</td>
    <td>{{ chemical['SMILES']  }}</td>
  </tr>
  <tr>
    <td>inchi</td>
    <td>{{ chemical['InChI']  }}</td>
  </tr>
  <tr>
    <td>names</td>
    <td>{{ chemical['names']['synonyms']  }}</td>
  </tr>
</table>
<br>
{% endfor %}
<h3>Products</h3>
{% for chemical in products %}
<table border="1">
  <tr>
    <td>ID</td>
    <td>{{ chemical['_id']  }}</td>
  </tr>
  <tr>
    <td>canonical</td>
    <td>{{ chemical['canonical']  }}</td>
  </tr>
  <tr>
    <td>smiles</td>
    <td>{{ chemical['SMILES']  }}</td>
  </tr>
  <tr>
    <td>inchi</td>
    <td>{{ chemical['InChI']  }}</td>
  </tr>
  <tr>
    <td>names</td>
    <td>{{ chemical['names']['synonyms']  }}</td>
  </tr>
</table>
<br>
{% endfor %}
<h3>Results from Inferring ERO</h3>
{% for res in filter_infer %}
<table border="1">
  {% for k, v in res.iteritems() %}
    <tr>
      <td>{{ k }}</td>
      <td>
        {% if k == 'EROIMG' %}
          <img src="{{ v }}">
        {% else %}
          {{ v }}
        {% endif %}
      </td>
    </tr>
  {% endfor %}
</table>
<br>
{% endfor %}
<h3>Results from Applying ERO</h3>
{% if filter_apply %}
  <table border="1">
    <tr>
      <td>Input Chemical</td>
      <td>
        <table border="0">
          <tr><td><img src="{{ filter_apply['inputimg'] }}"></td></tr>
          <tr><td>{{ filter_apply['input'] }}</td></tr>
        </table>
      </td>
    </tr>
    <tr>
      <td>ERO</td>
      <td>
        <table border="0">
          <tr><td><img src="{{ filter_apply['eroimg'] }}"></td></tr>
          <tr><td>{{ filter_apply['ero'] }}</td></tr>
        </table>
      </td>
    </tr>
    <tr>
      <td>Forward</td>
      {% for forward in filter_apply['forward'] %}
        <td>
          <table border="0">
            <tr><td><img src="{{ forward[1] }}"></td></tr>
            <tr><td>{{ forward[0] }}</td></tr>
          </table>
        </td>
      {% endfor %}
    </tr>
    <tr>
      <td>Reverse</td>
      {% for reverse in filter_apply['reverse'] %}
        <td>
          <table border="0">
            <tr><td><img src="{{ reverse[1] }}"></td></tr>
            <tr><td>{{ reverse[0] }}</td></tr>
          </table>
        </td>
      {% endfor %}
    </tr>
  </table>
  <br>
{% else %}
  None
{% endif %}

{% else %}
<p>
  Reaction not found.
</p>
<h3>Report Reactions</h3>
<table border="1">
{% for rep in report_reactions %}
  <tr>
    <td>{{ rep[0] }}</td>
    <td>{{ rep[1] }}</td>
  </tr>
{% endfor %}
</table>
{% endif %}

</body>
</html>
